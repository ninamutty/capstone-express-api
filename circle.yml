machine:
  services:
    - docker
  node:
    version: 6.7.0
  environment:
    PORT: 3000

dependencies:
  pre:
    - pip install awscli
    - docker build -t mreid30/docker-circleci-beanstalk-template:$CIRCLE_SHA1 .

deployment:
  production:
    branch: master
    commands:
      - docker login -u $DOCKER_USER -p $DOCKER_PASSWORD -e $DOCKER_EMAIL
      - chmod +x deploy.sh
      - ./deploy.sh
